<script>
  export let student
  $: events = app
    .service('events')
    .watch()
    .find({
      query: { studentId: student._id, $sort: { createdAt: -1 }, $limit: 10000 }
    })
  $: someEvents = $events && $events.data.length > 0
  $: moreEvents = $events && $events.data.length > 1
  $: eventCount = $events && $events.data.length
  let currentEvent = -1
</script>
<section>
  {#if $events} {#if someEvents}
  <div>
    <pre><code>{$events.data[~currentEvent ? currentEvent : $events.data.length - 1].source}</code></pre>
    {#if moreEvents}
    <ion-range
      min="0"
      max="{eventCount - 1}"
      step="1"
      value="{~currentEvent ? currentEvent : $events.data.length - 1}"
      on:ionChange="{(e) => currentEvent = e.detail.value === $events.data.length - 1 ? -1 : e.detail.value}"
    ></ion-range>
    {/if}
  </div>
  {:else}
  <p>No code yet</p>
  {/if} {:else} ... {/if}
</section>
